<!--pages/index/index.wxml-->
<view class="index-page">

  <!-- æœç´¢æ  -->
  <view class="search-bar" bindtap="onSearch">
    <view class="search-icon">ğŸ”</view>
    <view class="search-placeholder">æœç´¢é¤å…æˆ–èœå“...</view>
  </view>

  <!-- å…¬å‘Šè½®æ’­ -->
  <swiper wx:if="{{notices.length > 0}}"
    class="notice-swiper" autoplay circular
    bindchange="onNoticeChange">
    <swiper-item wx:for="{{notices}}" wx:key="_id">
      <view class="notice-item">
        <view class="notice-type">{{item.type === 'promotion' ? 'ä¼˜æƒ ' : item.type === 'system' ? 'ç³»ç»Ÿ' : 'å…¬å‘Š'}}</view>
        <view class="notice-title">{{item.title}}</view>
      </view>
    </swiper-item>
  </swiper>

  <!-- åˆ†åŒºç­›é€‰ -->
  <scroll-view class="zone-bar" scroll-x>
    <view wx:for="{{zones}}" wx:key="value"
      class="zone-item {{selectedZone === item.value ? 'active' : ''}}"
      bindtap="onZoneChange" data-index="{{index}}">
      {{item.label}}
    </view>
  </scroll-view>

  <!-- å•†å®¶åˆ—è¡¨ -->
  <view class="merchant-list">
    <view wx:if="{{loading && merchants.length === 0}}" class="loading-wrap">åŠ è½½ä¸­...</view>
    <view wx:elif="{{!loading && merchants.length === 0}}" class="empty-tip">
      æš‚æ— å•†å®¶ï¼Œæ•¬è¯·æœŸå¾…
    </view>
    <view wx:for="{{merchants}}" wx:key="_id"
      class="merchant-card" bindtap="onMerchantTap" data-id="{{item._id}}">
      <image class="merchant-cover" src="{{item.cover_image}}" mode="aspectFill"/>
      <view class="merchant-info">
        <view class="merchant-name">{{item.name}}</view>
        <view class="merchant-meta row">
          <view class="rating">â­ {{item.avg_rating}}</view>
          <view class="dot">Â·</view>
          <view class="location">{{item.location}}</view>
        </view>
        <view class="merchant-bottom row-between">
          <view class="min-order text-secondary text-sm">èµ·é€ Â¥{{item.min_order/100}}</view>
          <view class="status-tag {{item.status === 'open' ? 'open' : 'closed'}}">
            {{item.status === 'open' ? 'è¥ä¸šä¸­' : 'å·²æ‰“çƒŠ'}}
          </view>
        </view>
      </view>
    </view>
    <view wx:if="{{!hasMore && merchants.length > 0}}" class="no-more">æ²¡æœ‰æ›´å¤šäº†</view>
  </view>

</view>
