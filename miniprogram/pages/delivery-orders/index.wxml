<!--pages/delivery-orders/index.wxml â€” æ¥å•å¤§å…-->
<view class="delivery-orders-page">
  <view class="hall-header">
    <view class="header-title">æ¥å•å¤§å…</view>
    <view class="order-count text-sm">{{orders.length}} å• Â· {{tasks.length}} ä»»åŠ¡</view>
  </view>

  <!-- Tabåˆ‡æ¢ -->
  <view class="tab-bar-inner">
    <view class="tab-item {{activeTab === 'orders' ? 'active' : ''}}"
      bindtap="onTabChange" data-tab="orders">å¤–å–è®¢å•</view>
    <view class="tab-item {{activeTab === 'tasks' ? 'active' : ''}}"
      bindtap="onTabChange" data-tab="tasks">è·‘è…¿ä»»åŠ¡</view>
    <view class="tab-item {{activeTab === 'myOrders' ? 'active' : ''}}"
      bindtap="onTabChange" data-tab="myOrders">æˆ‘çš„æ¥å•</view>
  </view>

  <!-- å¤–å–è®¢å•åˆ—è¡¨ -->
  <block wx:if="{{activeTab === 'orders'}}">
    <view wx:if="{{loading}}" class="loading-wrap">åŠ è½½ä¸­...</view>
    <view wx:elif="{{orders.length === 0}}" class="empty-state">
      <view style="font-size:80rpx">ğŸ“­</view>
      <view class="text-secondary mt-16">æš‚æ— å¯æ¥è®¢å•</view>
    </view>
    <view wx:else>
      <view class="order-card card" wx:for="{{orders}}" wx:key="_id"
        bindtap="onOrderTap" data-id="{{item._id}}">
        <view class="order-head row-between">
          <view class="merchant-name text-bold">{{item.merchant_name}}</view>
          <view class="earn-fee text-primary text-bold">+Â¥{{item.delivery_fee/100}}</view>
        </view>
        <view class="order-locations text-sm mt-8">
          <view class="loc-line text-secondary">ğŸ“¦ å–é¤ï¼š{{item.pickup_location}}</view>
          <view class="loc-line text-secondary mt-4">ğŸ“ é€è¾¾ï¼š{{item.delivery_address.building}} {{item.delivery_address.room}}</view>
        </view>
        <view class="order-foot row-between mt-16">
          <view class="total text-secondary text-sm">è®¢å•é‡‘é¢ Â¥{{item.total_amount/100}}</view>
          <view class="accept-btn">ç«‹å³æ¥å• â€º</view>
        </view>
      </view>
    </view>
  </block>

  <!-- è·‘è…¿ä»»åŠ¡åˆ—è¡¨ -->
  <block wx:if="{{activeTab === 'tasks'}}">
    <view wx:if="{{tasks.length === 0}}" class="empty-state">
      <view style="font-size:80rpx">ğŸ“­</view>
      <view class="text-secondary mt-16">æš‚æ— å¯æ¥ä»»åŠ¡</view>
    </view>
    <view wx:else>
      <view class="order-card card" wx:for="{{tasks}}" wx:key="_id"
        bindtap="onTaskTap" data-id="{{item._id}}">
        <view class="order-head row-between">
          <view class="task-title text-bold">{{item.title}}</view>
          <view class="earn-fee text-primary text-bold">Â¥{{item.reward / 100}}</view>
        </view>
        <view class="task-desc text-secondary text-sm mt-8">{{item.description}}</view>
        <view class="order-locations text-sm mt-8" wx:if="{{item.pickup_location || item.delivery_location}}">
          <view class="loc-line text-secondary" wx:if="{{item.pickup_location}}">ğŸ“¦ å–ä»¶ï¼š{{item.pickup_location}}</view>
          <view class="loc-line text-secondary mt-4" wx:if="{{item.delivery_location}}">ğŸ“ é€è¾¾ï¼š{{item.delivery_location}}</view>
        </view>
        <view class="order-foot row-between mt-16">
          <view class="text-secondary text-xs">{{item.publisher_name}}</view>
          <view class="accept-btn">æ¥å–ä»»åŠ¡ â€º</view>
        </view>
      </view>
    </view>
  </block>

  <!-- æˆ‘çš„æ¥å•åˆ—è¡¨ -->
  <block wx:if="{{activeTab === 'myOrders'}}">
    <view wx:if="{{myOrdersLoading}}" class="loading-wrap">åŠ è½½ä¸­...</view>
    <view wx:elif="{{myOrders.length === 0}}" class="empty-state">
      <view style="font-size:80rpx">ğŸ“‹</view>
      <view class="text-secondary mt-16">è¿˜æ²¡æœ‰æ¥è¿‡å•</view>
    </view>
    <view wx:else>
      <view class="order-card card" wx:for="{{myOrders}}" wx:key="_id"
        bindtap="onMyOrderTap" data-id="{{item.order_id}}">
        <view class="order-head row-between">
          <view class="text-bold">è®¢å•é…é€</view>
          <view class="status-text text-sm {{item.status === 'delivered' ? 'text-success' : 'text-primary'}}">{{item.statusLabel}}</view>
        </view>
        <view class="order-foot row-between mt-12">
          <view class="text-secondary text-sm">é…é€æ”¶ç›Š</view>
          <view class="earn-fee text-primary text-bold">+Â¥{{item.delivery_fee_earned/100}}</view>
        </view>
      </view>
    </view>
  </block>
</view>
